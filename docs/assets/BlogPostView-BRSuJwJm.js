import{r as v,o as A,z as D,k as F,c as i,a as t,F as y,i as b,q as h,d as k,t as r,f as x,A as L,p as S,h as c,n as B}from"./vendor-4AoAK_Kz.js";import{_ as T,l as V,a as P}from"./index-CvE6R91A.js";import"./markdown-JKvyS0Pp.js";const H={class:"blog-post-container"},O={class:"left-sidebar"},q={class:"sidebar-content"},N={class:"post-list"},R=["onClick"],$=["data-text"],z={class:"post-date"},j={class:"main-content"},G={key:0,class:"loading-state"},J={key:1,class:"error-state"},K={key:2,class:"blog-post"},Q={class:"post-header"},U={class:"post-meta"},W={class:"date"},X={class:"category"},Y={class:"subcategory"},Z=["innerHTML"],tt={class:"right-sidebar"},et={class:"sidebar-content"},st={key:0,class:"table-of-contents"},at={class:"toc-list"},ot=["onClick"],lt=["data-text"],nt={key:1,class:"article-meta-sidebar"},rt={class:"meta-item"},it={class:"meta-value"},ct={class:"meta-item"},dt={class:"meta-value"},ut={class:"meta-item"},vt={class:"meta-value"},mt={class:"navigation-links"},pt={__name:"BlogPostView",setup(_t){const w=S(),C=D(),_=v(""),m=v([]),f=v([]),s=v(null),p=v(!0),d=v(null);A(async()=>{try{p.value=!0,d.value=null;const{posts:l}=await V();if(f.value=l,s.value=await P(C.params.slug),!s.value){d.value="Post not found";return}const u=new DOMParser().parseFromString(s.value.content,"text/html");m.value=Array.from(u.querySelectorAll("h2")).map(a=>({id:a.id,text:a.textContent}));const o=new IntersectionObserver(a=>{a.forEach(n=>{n.isIntersecting&&(_.value=n.target.id)})},{rootMargin:"-20% 0px -80% 0px"});m.value.forEach(a=>{const n=document.getElementById(a.id);n&&o.observe(n)})}catch(l){console.error("Error loading post:",l),d.value="Failed to load post. Please try again later."}finally{p.value=!1}});const g=l=>{const e={year:"numeric",month:"short",day:"numeric"};return new Date(l).toLocaleDateString(void 0,e)},E=F(()=>{const l=s.value.content.replace(/<[^>]*>/g,"").split(/\s+/).length;return Math.ceil(l/200)}),I=l=>{const e=document.getElementById(l);e&&e.scrollIntoView({behavior:"smooth"})},M=async l=>{try{if(p.value=!0,d.value=null,s.value=await P(l),!s.value){d.value="Post not found";return}w.push(`/blog/${l}`,void 0,{shallow:!0});const u=new DOMParser().parseFromString(s.value.content,"text/html");m.value=Array.from(u.querySelectorAll("h2")).map(a=>({id:a.id,text:a.textContent}));const o=new IntersectionObserver(a=>{a.forEach(n=>{n.isIntersecting&&(_.value=n.target.id)})},{rootMargin:"-20% 0px -80% 0px"});m.value.forEach(a=>{const n=document.getElementById(a.id);n&&o.observe(n)})}catch(e){console.error("Error loading post:",e),d.value="Failed to load post. Please try again later."}finally{p.value=!1}};return(l,e)=>{const u=L("router-link");return c(),i("div",H,[t("aside",O,[t("div",q,[e[0]||(e[0]=t("div",{class:"sidebar-header"},[t("h2",null,"Posts")],-1)),t("div",N,[(c(!0),i(y,null,b(f.value,o=>{var a;return c(),i("div",{key:o.id,class:B([{active:((a=s.value)==null?void 0:a.slug)===o.slug},"post-item"]),onClick:n=>M(o.slug)},[t("span",{class:"post-title","data-text":o.title},r(o.title),9,$),t("span",z,r(g(o.date)),1)],10,R)}),128))])])]),t("main",j,[p.value?(c(),i("div",G,e[1]||(e[1]=[t("div",{class:"loading-spinner"},null,-1),t("p",null,"Loading post...",-1)]))):d.value?(c(),i("div",J,[e[3]||(e[3]=t("h2",null,"Error Loading Post",-1)),t("p",null,r(d.value),1),k(u,{to:"/blog",class:"nav-link"},{default:x(()=>e[2]||(e[2]=[t("span",{class:"link-text","data-text":"← Back to Blog"},"← Back to Blog",-1)])),_:1})])):s.value?(c(),i("article",K,[t("header",Q,[t("h1",null,r(s.value.title),1),t("div",U,[t("span",W,r(g(s.value.date)),1),t("span",X,r(s.value.category),1),t("span",Y,r(s.value.subCategory),1)])]),t("div",{class:"post-content",innerHTML:s.value.content},null,8,Z)])):h("",!0)]),t("aside",tt,[t("div",et,[e[10]||(e[10]=t("div",{class:"sidebar-header"},[t("h2",null,"Article Menu")],-1)),s.value?(c(),i("div",st,[e[4]||(e[4]=t("h3",null,"Contents",-1)),t("ul",at,[(c(!0),i(y,null,b(m.value,(o,a)=>(c(),i("li",{key:a,class:B([{active:_.value===o.id},"toc-item"]),onClick:n=>I(o.id)},[t("span",{class:"toc-text","data-text":o.text},r(o.text),9,lt)],10,ot))),128))])])):h("",!0),s.value?(c(),i("div",nt,[e[8]||(e[8]=t("h3",null,"Article Info",-1)),t("div",rt,[e[5]||(e[5]=t("span",{class:"meta-label"},"Published:",-1)),t("span",it,r(g(s.value.date)),1)]),t("div",ct,[e[6]||(e[6]=t("span",{class:"meta-label"},"Category:",-1)),t("span",dt,r(s.value.category)+" / "+r(s.value.subCategory),1)]),t("div",ut,[e[7]||(e[7]=t("span",{class:"meta-label"},"Reading Time:",-1)),t("span",vt,r(E.value)+" min read",1)])])):h("",!0),t("div",mt,[k(u,{to:"/blog",class:"nav-link"},{default:x(()=>e[9]||(e[9]=[t("span",{class:"link-text","data-text":"← Back to Blog"},"← Back to Blog",-1)])),_:1})])])])])}}},yt=T(pt,[["__scopeId","data-v-0b247d5d"]]);export{yt as default};
